погуглить про индексирование столбцов
подумать над временной базой данных